{
final <- rbind(final, c(species, x, '---', cdns1[x], cdns1[x+1], '---', cdns2[x], cdns2[x+1], taa1, taa2))
}
if (x == length(codonposition))
{
final <- rbind(final, c(species, x, cdns1[x-1], cdns1[x], '---', cdns2[x-1], cdns2[x], '---', taa1, taa2))
}
da <- data.frame(final)
colnames(da) <- c("Species", "CodonPosition", "PreviousAncCodon", "AncestorCodon", "NextAncCodon", "PreviousDesCodon", "DescendantCodon", "NextDesCodon", "AncestralAA", "DescendantAA")
codonTable = rbind(codonTable, da)
}
}
}
warnings()
View(codonTable)
View(da)
View(da)
View(codonTable)
codonTable = as.data.frame(NULL)
for (y in 1:nrow(anc_desSeqs)){
# y = 1
mdns <- as.character(anc_desSeqs$State[y])
msns <- toupper(as.character(anc_desSeqs$Seqs[y]))
s1 <- s2c(mdns)       #conversion of a string into a vector of chars
s2 <-  s2c(msns)
cdns1 <- splitseq(s1, 0, 3) #split a sequence into sub-sequences (codons)
cdns2 <- splitseq(s2, 0, 3)
codonposition <-c(1:length(cdns1))
final <- c()
#allframes <- c()
for (x in codonposition){
# x = 1
if (cdns1[x] != cdns2[x]){
taa1 <- translate(s2c(cdns1[x]), frame = 0, sens = "F", numcode = 5, NAstring = "X", ambiguous = FALSE)
taa2 <- translate(s2c(cdns2[x]), frame = 0, sens = "F", numcode = 5, NAstring = "X", ambiguous = FALSE)
species <- anc_desSeqs$Species[y]
print(c(species, x))
if (x > 1 & x < length(codonposition))
{
final <- rbind(final, c(species, x, cdns1[x-1], cdns1[x], cdns1[x+1], cdns2[x-1], cdns2[x], cdns2[x+1], taa1, taa2))
}
if (x == 1)
{
final <- rbind(final, c(species, x, '---', cdns1[x], cdns1[x+1], '---', cdns2[x], cdns2[x+1], taa1, taa2))
}
if (x == length(codonposition))
{
final <- rbind(final, c(species, x, cdns1[x-1], cdns1[x], '---', cdns2[x-1], cdns2[x], '---', taa1, taa2))
}
}
}
da <- data.frame(final)
colnames(da) <- c("Species", "CodonPosition", "PreviousAncCodon", "AncestorCodon", "NextAncCodon", "PreviousDesCodon", "DescendantCodon", "NextDesCodon", "AncestralAA", "DescendantAA")
codonTable = rbind(codonTable, da)
}
View(codonTable)
table(codonTable$Species)
write.table(codonTable, 'results/PolarizeMutations.CodonsTable.txt')
write.table(codonTable, 'results/PolarizeMutations.CodonsTable.txt', sep = '\t', quote = FALSE, row.names = FALSE)
setwd('../TermitesMutSpectrum/AllTermites/')
codonTable = read.table('results/PolarizeMutations.CodonsTable.txt', sep='\t', header=TRUE)
View(codonTable)
withGapsCodonTable = codonTable[codonTable$DescendantCodon != '---']
withGapsCodonTable = codonTable[codonTable$DescendantCodon != '---',]
View(withGapsCodonTable)
withoutGapsCodonTable = codonTable[codonTable$DescendantCodon != '---',]
FirstCodon = withoutGapsCodonTable$AncestorCodon
SecondCodon = withoutGapsCodonTable$DescendantCodon
View(withoutGapsCodonTable)
withoutGapsCodonTable = codonTable[as.character(codonTable$DescendantCodon) != '---',]
FirstCodon = withoutGapsCodonTable$AncestorCodon
SecondCodon = withoutGapsCodonTable$DescendantCodon
data = data.frame(FirstCodon,SecondCodon)
View(data)
data$FirstSecond = paste(data$FirstCodon,data$SecondCodon,sep = '_')
View(data)
COMPAR<-function(x)	{
cod1 <- unlist(strsplit(x,'_'))[1]
cod2 <- unlist(strsplit(x,'_'))[2]
#table <- c("FirstCOD", "SecondCOD")
NumSub <- 0
unlist(strsplit(cod1,''))[1]
if (unlist(strsplit(cod1,''))[1] != unlist(strsplit(cod2,''))[1]){
NumSub = 1 + NumSub
FirstC <- unlist(strsplit(cod1,''))[1]
SecC <- unlist(strsplit(cod2,''))[1]
}
if (unlist(strsplit(cod1,''))[2] != unlist(strsplit(cod2,''))[2]){
NumSub = 1 + NumSub
FirstC <- unlist(strsplit(cod1,''))[2]
SecC <- unlist(strsplit(cod2,''))[2]
}
if (unlist(strsplit(cod1,''))[3] != unlist(strsplit(cod2,''))[3])
{
NumSub = 1 + NumSub
FirstC <- unlist(strsplit(cod1,''))[3]
SecC <- unlist(strsplit(cod2,''))[3]
}
if (NumSub == 1) {nucleotides <- paste(FirstC,SecC,sep='_')}
if (NumSub > 1)  {nucleotides  = 'MoreThanOne_SUBST'}
return(nucleotides);
}
data$Subst = apply(as.matrix(data$FirstSecond),1,COMPAR)
View(data)
withoutGapsCodonTable$Subs = data$Subst
View(withoutGapsCodonTable)
table = withoutGapsCodonTable[table$Subs != 'MoreThanOne_SUBST',]
tableSubs = withoutGapsCodonTable[table$Subs != 'MoreThanOne_SUBST',]
tableSubs = withoutGapsCodonTable[withoutGapsCodonTable$Subs != 'MoreThanOne_SUBST',]
View(tableSubs)
library(ggplot2)
ggplot(tableSubs, aes(x = Subs)) +
geom_histogram(stat = 'count')
mut = tableSubs[which(!(tableSubs$Subs %in% c('A_N', 'A_R', 'C_N', 'G_N', 'T_K', 'T_N', 'T_Y'))),]
ggplot(tableSubs, aes(x = Subs)) +
geom_histogram(stat = 'count')
tableSubs$Subs = as.character(tableSubs$Subs)
mut = tableSubs[which(!(tableSubs$Subs %in% c('A_N', 'A_R', 'C_N', 'G_N', 'T_K', 'T_N', 'T_Y'))),]
ggplot(tableSubs, aes(x = Subs)) +
geom_histogram(stat = 'count')
ggplot(mut, aes(x = Subs)) +
geom_histogram(stat = 'count')
table(mut$Subs)
mut = tableSubs[which(!(tableSubs$Subs %in% c('A_N', 'A_R', 'C_N', 'G_N', 'T_K', 'T_N', 'T_Y',
'-_A', '-_C', 'C_Y', '-_G', 'G_R', '-_T'))),]
ggplot(mut, aes(x = Subs)) +
geom_histogram(stat = 'count')
syn = mut[as.character(mut$AncestralAA) == as.character(mut$DescendantAA),]
ggplot(syn, aes(x = Subs)) +
geom_histogram(stat = 'count')
pdf('results/HistOfSubs.pdf')
ggplot(mut, aes(x = Subs)) +
geom_histogram(stat = 'count')
dev.off()
codonTable = read.table('results/PolarizeMutations.CodonsTable.txt', sep='\t', header=TRUE)
withoutGapsCodonTable = codonTable[as.character(codonTable$DescendantCodon) != '---',]
FirstCodon = withoutGapsCodonTable$AncestorCodon
SecondCodon = withoutGapsCodonTable$DescendantCodon
data = data.frame(FirstCodon,SecondCodon)
data$FirstSecond = paste(data$FirstCodon,data$SecondCodon,sep = '_')
COMPAR<-function(x)	{
cod1 <- unlist(strsplit(x,'_'))[1]
cod2 <- unlist(strsplit(x,'_'))[2]
#table <- c("FirstCOD", "SecondCOD")
NumSub <- 0
unlist(strsplit(cod1,''))[1]
if (unlist(strsplit(cod1,''))[1] != unlist(strsplit(cod2,''))[1]){
NumSub = 1 + NumSub
FirstC <- unlist(strsplit(cod1,''))[1]
SecC <- unlist(strsplit(cod2,''))[1]
}
if (unlist(strsplit(cod1,''))[2] != unlist(strsplit(cod2,''))[2]){
NumSub = 1 + NumSub
FirstC <- unlist(strsplit(cod1,''))[2]
SecC <- unlist(strsplit(cod2,''))[2]
}
if (unlist(strsplit(cod1,''))[3] != unlist(strsplit(cod2,''))[3])
{
NumSub = 1 + NumSub
FirstC <- unlist(strsplit(cod1,''))[3]
SecC <- unlist(strsplit(cod2,''))[3]
}
if (NumSub == 1) {nucleotides <- paste(FirstC,SecC,sep='_')}
if (NumSub > 1)  {nucleotides  = 'MoreThanOne_SUBST'}
return(nucleotides);
}
data$Subst = apply(as.matrix(data$FirstSecond),1,COMPAR)
withoutGapsCodonTable$Subs = data$Subst
tableSubs = withoutGapsCodonTable[withoutGapsCodonTable$Subs != 'MoreThanOne_SUBST',]
tableSubs$Subs = as.character(tableSubs$Subs)
mut = tableSubs[which(!(tableSubs$Subs %in% c('A_N', 'A_R', 'C_N', 'G_N', 'T_K', 'T_N', 'T_Y',
'-_A', '-_C', 'C_Y', '-_G', 'G_R', '-_T'))),]
View(mut)
syn = mut[as.character(mut$AncestralAA) == as.character(mut$DescendantAA),]
write.table(mut, 'results/AllSubs.txt', row.names = FALSE, quote = FALSE)
write.table(syn, 'results/SynSubs.txt', row.names = FALSE, quote = FALSE)
VecOfSynFourFoldDegenerateSites <- c('CTT', 'CTC', 'CTA', 'CTG',
'GTT', 'GTC', 'GTA', 'GTG',
'TCT', 'TCC', 'TCA', 'TCG',
'CCT', 'CCC', 'CCA', 'CCG',
'ACT', 'ACC', 'ACA', 'ACG',
'GCT', 'GCC', 'GCA', 'GCG',
'CGT', 'CGC', 'CGA', 'CGG',
'GGT', 'GGC', 'GGA', 'GGG',
'AGT', 'AGC', 'AGA', 'AGG')
length(unique(VecOfSynFourFoldDegenerateSites)) # 32
mut4f = mut[mut$AncestorCodon %in% VecOfSynFourFoldDegenerateSites & mut$DescendantCodon %in% VecOfSynFourFoldDegenerateSites,]; nrow(mut4f) # 209120
write.table(mut4f, 'results/4foldSubs.txt', row.names = FALSE, quote = FALSE)
table(mut4f$Species)
length(table(mut4f$Species))
mut = read.table('results/4foldSubs.txt', header = TRUE, sep='\t')
View(mut)
write.table(mut, 'results/AllSubs.txt', sep='\t', row.names = FALSE, quote = FALSE)
write.table(syn, 'results/SynSubs.txt', sep='\t', row.names = FALSE, quote = FALSE)
write.table(mut4f, 'results/4foldSubs.txt', sep='\t', row.names = FALSE, quote = FALSE)
mut = read.table('results/4foldSubs.txt', header = TRUE, sep='\t')
View(mut)
library(ape)
tree = read.tree('results/phylogeny/iqtree_mito.treefile')
View(tree)
numberOfSpecies = length(tree$tip.label)
a = as.data.frame(tree$edge)
a = cbind(a, tree$edge.length)
externalBranches = a[a$V2 <= numberOfSpecies,]
externalBranches = cbind(externalBranches, tree$tip.label)
names(externalBranches) = c('Node', 'Tip', 'BranchLength', 'Species')
View(externalBranches)
View(externalBranches)
data = merge(mut, externalBranches[, c('Species', 'BranchLength')], by='Species')
View(data)
mut$Subs = as.character(mut$Subs)
mutTable = setNames(data.frame(matrix(0, ncol = 12, nrow = 37)), unique(mut$Subs))
View(mutTable)
speciesNumber = length(unique(mut$Species))
mutTable = setNames(data.frame(matrix(0, ncol = 12, nrow = speciesNumber)), unique(mut$Subs))
Species = unique(mut$Species)
mutTable = cbind(Species, mutTable)
View(mutTable)
for(i in 1:nrow(mut)){
row = mut[i, ]
mutTable[mutTable$Species == row$Species, row$Subs] = mutTable[mutTable$Species == row$Species, row$Subs] + 1
}
table(mut[mut$Species == "Macrotermes_gilvus",]$Subs)
View(mutTable)
table(mut[mut$Species == "AUS49_Tumulitermes_sp._1",]$Subs)
data = merge(mutTable, externalBranches[, c('Species', 'BranchLength')], by='Species')
View(data)
View(a)
a = matrix(0, ncol=12, nrow=speciesNumber)
a[,1]
View(data)
for(i in 1:12){
a[, i] = data[, i+1] / data$BranchLength
}
View(a)
names(a)
rates = as.data.frame(a)
View(rates)
View(mutTable)
names(rates) = names(mutTable)
names(rates) = names(mutTable[, -1])
View(rates)
names(rates) = paste(names(mutTable[, -1]), '.rates')
View(rates)
names(rates) = paste(names(mutTable[, -1]), '_rate')
View(rates)
names(rates) = paste(names(mutTable[, -1])[1:-1], '_rate')
names(rates) = paste(names(mutTable[, -1])[0:-1], '_rate')
names(rates) = paste(names(mutTable[, -1])[0:-2], '_rate')
?sub
names(rates) = sub(' ', '', paste(names(mutTable[, -1]), '_rate'))
View(mutTable)
View(data)
subsRates = cbind(data, rates)
View(subsRates)
write.table(subsRates, 'results/4foldSubsRates.txt', sep='\t', row.names = FALSE, quote = FALSE)
library(ape)
mut = read.table('results/4foldSubs.txt', header = TRUE, sep='\t')
tree = read.tree('results/phylogeny/iqtree_mito.treefile')
numberOfSpecies = length(tree$tip.label)
is.rooted(tree)
a = root(tree, 'Locusta_migratoria_1')
is.rooted(a)
a = as.data.frame(tree$edge)
a = cbind(a, tree$edge.length)
externalBranches = a[a$V2 <= numberOfSpecies,]
externalBranches = cbind(externalBranches, tree$tip.label)
names(externalBranches) = c('Node', 'Tip', 'BranchLength', 'Species')
View(a)
View(a)
View(externalBranches)
a = root(tree, node = 990)
is.rooted(a)
View(a)
a = root(tree, node = 990, resolve.root	= TRUE)
is.rooted(a)
View(a)
plot(a)
pdf('rootedTree.pdf', width = 100, height = 200)
plot(a)
dev.off()
is.rooted(a)
pdf('rootedTree.pdf', width = 100, height = 300)
plot(a)
dev.off()
pdf('rootedTree.pdf', width = 50, height = 300)
plot(a)
dev.off()
pdf('rootedTree.pdf', width = 30, height = 400)
plot(a)
dev.off()
pdf('rootedTree.pdf', width = 30, height = 400)
plot(a, root.edge = TRUE)
dev.off()
pdf('rootedTree.pdf', width = 50, height = 300)
plot(a, root.edge = TRUE)
dev.off()
pdf('rootedTree.pdf', width = 150, height = 300)
plot(a, root.edge = TRUE)
dev.off()
pdf('rootedTree.pdf', width = 50, height = 300)
plot.phylo(a, root.edge = TRUE)
dev.off()
pdf('rootedTree.pdf', width = 50, height = 300)
plot.phylo(a, root.edge = TRUE, no.margin = TRUE)
dev.off()
rootedTree = root(tree, node = 990, resolve.root	= TRUE)
is.rooted(rootedTree)
rootedTree = root(tree, 'Locusta_migratoria_1', resolve.root	= TRUE)
a = as.data.frame(tree$edge)
a = cbind(a, tree$edge.length)
externalBranches = a[a$V2 <= numberOfSpecies,]
externalBranches = cbind(externalBranches, tree$tip.label)
names(externalBranches) = c('Node', 'Tip', 'BranchLength', 'Species')
View(externalBranches)
brLenMore05 = externalBranches[externalBranches$BranchLength > 0.05,]
brLenLess05 = externalBranches[externalBranches$BranchLength < 0.05,]
brLenLess05 = externalBranches[externalBranches$BranchLength < 0.02,]
brLenLess05 = externalBranches[externalBranches$BranchLength < 0.05,]
brLenLess02 = externalBranches[externalBranches$BranchLength < 0.02,]
View(brLenLess05)
brLenMore05 = externalBranches[externalBranches$BranchLength > 0.05,]
brLenMore02 = externalBranches[externalBranches$BranchLength > 0.02,]
treeMore05 = drop.tip(rootedTree, brLenLess05$Species)
brLenLess05$Species
treeMore05 = drop.tip(rootedTree, as.character(brLenLess05$Species))
length(treeMore05$tip.label)
treeMore02 = drop.tip(rootedTree, as.character(brLenLess02$Species))
length(treeMore02$tip.label)
View(externalBranches)
mut$Subs = as.character(mut$Subs)
speciesNumber = length(unique(mut$Species))
mutTable = setNames(data.frame(matrix(0, ncol = 12, nrow = speciesNumber)), unique(mut$Subs))
Species = unique(mut$Species)
mutTable = cbind(Species, mutTable)
for(i in 1:nrow(mut)){
row = mut[i, ]
mutTable[mutTable$Species == row$Species, row$Subs] = mutTable[mutTable$Species == row$Species, row$Subs] + 1
}
table(mut[mut$Species == "AUS49_Tumulitermes_sp._1",]$Subs)
data = merge(mutTable, externalBranches[, c('Species', 'BranchLength')], by='Species')
a = matrix(0, ncol=12, nrow=speciesNumber)
for(i in 1:12){
a[, i] = data[, i+1] / data$BranchLength
}
rates = as.data.frame(a)
names(rates) = sub(' ', '', paste(names(mutTable[, -1]), '_rate'))
subsRates = cbind(data, rates)
View(subsRates)
View(externalBranches)
a = as.data.frame(tree$edge)
a = as.data.frame(rootedTree$edge)
View(a)
a = cbind(a, rootedTree$edge.length)
externalBranches = a[a$V2 <= numberOfSpecies,]
externalBranches = cbind(externalBranches, tree$tip.label)
names(externalBranches) = c('Node', 'Tip', 'BranchLength', 'Species')
View(externalBranches)
brLenLess05 = externalBranches[externalBranches$BranchLength < 0.05,]
brLenMore05 = externalBranches[externalBranches$BranchLength > 0.05,]
brLenLess02 = externalBranches[externalBranches$BranchLength < 0.02,]
brLenMore02 = externalBranches[externalBranches$BranchLength > 0.02,]
treeMore05 = drop.tip(rootedTree, as.character(brLenLess05$Species))
length(treeMore05$tip.label)
treeMore02 = drop.tip(rootedTree, as.character(brLenLess02$Species))
length(treeMore02$tip.label)
View(mutTable)
View(externalBranches)
View(data)
data = merge(mutTable, externalBranches[, c('Species', 'BranchLength')], by='Species')
dataMore05 = data[data$BranchLength > 0.05, ]
a = as.data.frame(rootedTree$edge)
a = cbind(a, rootedTree$edge.length)
externalBranches = a[a$V2 <= numberOfSpecies,]
externalBranches = cbind(externalBranches, tree$tip.label)
names(externalBranches) = c('Node', 'Tip', 'BranchLength', 'Species')
data = merge(mutTable, externalBranches[, c('Species', 'BranchLength')], by='Species')
View(mutTable)
View(externalBranches)
View(mutTable)
View(mutTable)
mutTable = cbind(Species, mutTable)
speciesNumber = length(unique(mut$Species))
View(externalBranches)
mutTable = setNames(data.frame(matrix(0, ncol = 12, nrow = speciesNumber)), unique(mut$Subs))
Species = unique(mut$Species)
mutTable = cbind(Species, mutTable)
for(i in 1:nrow(mut)){
row = mut[i, ]
mutTable[mutTable$Species == row$Species, row$Subs] = mutTable[mutTable$Species == row$Species, row$Subs] + 1
}
table(mut[mut$Species == "AUS49_Tumulitermes_sp._1",]$Subs)
data = merge(mutTable, externalBranches[, c('Species', 'BranchLength')], by='Species')
dataMore05 = data[data$BranchLength > 0.05, ]
dataMore02 = data[data$BranchLength > 0.02, ]
View(dataMore02)
a = matrix(0, ncol=12, nrow=speciesNumber)
for(i in 1:12){
a[, i] = dataMore02[, i+1] / dataMore02$BranchLength
}
View(a)
View(dataMore02)
a = matrix(0, ncol=12, nrow=unique(dataMore02$Species))
a = matrix(0, ncol=12, nrow=length(unique(dataMore02$Species)))
for(i in 1:12){
a[, i] = dataMore02[, i+1] / dataMore02$BranchLength
}
View(a)
rates = as.data.frame(a)
names(rates) = sub(' ', '', paste(names(mutTable[, -1]), '_rate'))
subsRates = cbind(data, rates)
subsRates = cbind(dataMore02, rates)
View(dataMore02)
write.table(subsRates, 'results/4foldSubsRatesBrLen02.txt', sep='\t', row.names = FALSE, quote = FALSE)
read.table('results/4foldSubsRatesBrLen02.txt', header=TRUE, sep='\t')
mut = read.table('results/4foldSubsRatesBrLen02.txt', header=TRUE, sep='\t')
View(mut)
plot(mut$C_T, mut$BranchLength)
plot(mut$C_T_rate, mut$BranchLength)
cor.test(mut$C_T_rate, mut$BranchLength)
lin_model = lm(BranchLength ~ C_T_Rate, mut)
lin_model = lm(BranchLength ~ C_T_rate, mut)
View(lin_model)
summary(lin_model)
lin_model$residuals
a = as.matrix(lin_model$residuals)
View(a)
a = as.data.frame(lin_model$residuals)
b = cbind(a, mut$Species)
View(b)
write.tree(rootedTree, 'results/rootedTree.newick')
res = as.data.frame(NULL)
for(i in 15:26){
lin_model = lm(mut[, i] ~ mut$BranchLength)
res = cbind(res, lin_model$residuals)
}
View(lin_model)
res = as.data.frame(matrix(nrow = nrow(mut)))
View(res)
for(i in 15:26){
lin_model = lm(mut[, i] ~ mut$BranchLength)
res = cbind(res, lin_model$residuals)
}
View(res)
res = res[, -1]
View(res)
names(res) = sub(' ', '', paste(names(mut), '.res'))
names(res) = sub(' ', '', paste(names(mut[15:26]), '.res'))
View(res)
View(mut)
mut = cbind(mut, res)
View(mut)
plot(mut$BranchLength, mut$C_T_rate.res)
plot(mut$C_T_rate.res, mut$BranchLength)
lin_model = lm(BranchLength ~ C_T_rate, mut)
summary(lin_model)
lin_model$residuals
lin_model = lm(C_T_rate ~ BranchLength, mut)
summary(lin_model)
lin_model$residuals
View(mut)
plot(mut$C_T_rate.res, mut$BranchLength)
plot(mut$A_G_rate, mut$BranchLength)
plot(mut$A_G_rate.res, mut$BranchLength)
MATRIX = mut[, c(27:38)]
row.names(MATRIX)=mut$Species
matrix = MATRIX
PCA = prcomp(matrix, center = TRUE, scale = TRUE) #FALSE) # I don't scale because we analyze the same units (fraction from MutSpec)
print(PCA)
summary(PCA)
MATRIX$Pca1 = PCA$x[,1]
MATRIX$Pca2 = PCA$x[,2]
MATRIX$Pca3 = PCA$x[,3]
MATRIX$Pca4 = PCA$x[,4]
biplot(PCA, choices=c(1,2), col = c('white','black'), cex = 0.8) #  biplot(princomp(USArrests),choices=c(1,3))
MATRIX = mut[, c(2:13)]
row.names(MATRIX)=mut$Species
matrix = MATRIX
PCA = prcomp(matrix, center = TRUE, scale = TRUE) #FALSE) # I don't scale because we analyze the same units (fraction from MutSpec)
print(PCA)
summary(PCA)
biplot(PCA, choices=c(1,2), col = c('white','black'), cex = 0.8) #  biplot(princomp(USArrests),choices=c(1,3))
pdf('results/PCA.pdf')
biplot(PCA, choices=c(1,2), col = c('white','black'), cex = 0.8) #  biplot(princomp(USArrests),choices=c(1,3))
dev.off()
plot(mut$A_G_rate, mut$BranchLength)
plot(mut$A_G_rate.res, mut$BranchLength)
cor.test(mut$A_G_rate.res, mut$BranchLength)
cor.test(mut$A_G_rate, mut$BranchLength)
mut = read.table('results/4foldSubsRatesBrLen02.txt', header=TRUE, sep='\t')
plot(mut$C_T_rate, mut$BranchLength)
lin_model = lm(C_T_rate ~ BranchLength, mut)
summary(lin_model)
lin_model$residuals
res = as.data.frame(matrix(nrow = nrow(mut)))
for(i in 15:26){
lin_model = lm(mut[, i] ~ mut$BranchLength)
res = cbind(res, lin_model$residuals)
}
res = res[, -1]
names(res) = sub(' ', '', paste(names(mut[15:26]), '.res'))
mut = cbind(mut, res)
plot(mut$C_T_rate.res, mut$BranchLength)
plot(mut$A_G_rate, mut$BranchLength)
plot(mut$A_G_rate.res, mut$BranchLength)
cor.test(mut$A_G_rate, mut$BranchLength)
cor.test(mut$A_G_rate.res, mut$BranchLength)
View(res)
View(res)
View(mut)
summary(mut$BranchLength)
write.table(mut, 'results/4foldSubsRatesBrLen02Residuals.txt')
