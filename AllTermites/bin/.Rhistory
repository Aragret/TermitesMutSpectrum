# x is dataframe with 12 column (subs types), name is a title of graph
a = as.data.frame(as.numeric(apply(x, 2, sum)))
data = cbind(names(x), a)
names(data) = c('Subs', 'Number')
ggbarplot(data, 'Subs', 'Number', xlab="Substitution types", title = name,
fill = 'Subs', color = 'Subs', palette = c("#bdbdbd", "#7fcdbb", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#feb24c", "#f03b20", "#bdbdbd", "#bdbdbd", "#bdbdbd", "#2c7fb8", "#bdbdbd"), combine = TRUE)
}
plot_hist(workers[, 2:13], 'workers')
withoutWorkers = mut[(mut$Worker == 0) & !is.na(mut$Worker),]
plot_hist(withoutWorkers[, 2:13], 'without workers')
summary(workers$Taxonomy)
table(withoutWorkers$Taxonomy)
mut$TsTv = (mut$C_T + mut$A_G + mut$T_C + mut$G_A) / (mut$G_T + mut$A_T + mut$G_C +
mut$A_C + mut$C_A + mut$C_G +
mut$T_A + mut$T_G)
mut$Ts = mut$C_T + mut$A_G + mut$T_C + mut$G_A
mut$Tv = mut$G_T + mut$A_T + mut$G_C +  mut$A_C + mut$C_A + mut$C_G + mut$T_A + mut$T_G
workers = mut[mut$Worker == 1,]
workers = workers[!is.na(workers$Worker),]
withoutWorkers = mut[(mut$Worker == 0) & !is.na(mut$Worker),]
filter_workers = rbind(workers, withoutWorkers)
summary(filter_workers$TsTv)
cockroaches = c('Ectobiidae1', 'Tryonicidae', 'Blaberidae', 'Corydiidae', 'Ectobiidae2',
'Lamproblattidae', 'Anaplectidae', 'Blattidae', 'Cryptocercidae', 'Ectobiidae3',
'Nocticolidae')
mut = mut[!is.na(mut$Taxonomy),]
for(i in 1:nrow(mut)){
if(mut$Taxonomy[i] %in% cockroaches){
mut$Cockroaches[i] = 1
}
if(!(mut$Taxonomy[i] %in% cockroaches))
{mut$Cockroaches[i] = 0}
}
mut$Cockroaches = as.factor(mut$Cockroaches)
summary(mut$Cockroaches)
ggplot(mut, aes(TsTv, fill = mut$Cockroaches)) +
# geom_histogram(aes(fill = filter_workers$Worker), alpha = 0.4) +
geom_histogram( color="#e9ecef", alpha=0.4, position = 'dodge') +
scale_fill_manual(values=c("#69b3a2", "#404080"))
View(mut)
write.table(mut, '../results/cockroaches11_19/MutSpecCockroachesTsTv.txt', sep='\t', quote = FALSE, row.names = FALSE)
rm(list=ls(all=TRUE))
mut = read.table('../results/cockroaches11_19/MutSpecCockroachesTsTv.txt', sep='\t', header=TRUE)
View(mut)
plot(mut$sumOfSubs, mut$BranchLength)
plot(mut$sumOfSubs, mut$TsTv)
cor.test(mut$sumOfSubs, mut$TsTv, method = 'spearman')
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
cor.test(mut$Ts, mut$Tv, method = 'spearman')
a = lm(Ts ~ Tv, mut)
a
summary(a)
res = a$residuals
cor.test(mut$sumOfSubs, res)
cor.test(mut$BranchLength, res, method = 'spearman')
plot(mut$BranchLength, res)
plot(mut$BranchLength, scale(res))
cor.test(mut$Ts, mut$Tv, method = 'spearman')
plot(mut$TsTv, mut$BranchLength)
cor.test(mut$sumOfSubs, mut$TsTv, method = 'spearman')
cor.test(mut$TsTv, mut$BranchLength)
plot(mut$Ts, mut$Tv)
cor.test(mut$Ts, mut$Tv, method = 'spearman')
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
plot(mut$sumOfSubs, mut$BranchLength)
pdf('../results/cockroaches11_19/TsTvNormalization.R.pdf')
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
dev.off()
plot(mut$sumOfSubs, mut$TsTv)
cor.test(mut$sumOfSubs, mut$TsTv, method = 'spearman')
plot(mut$sumOfSubs, mut$TsTv)
summary(glm(Cockroaches ~ TsTv + sumOfSubs, data=mut))
?glm
summary(glm(Cockroaches ~ TsTv + sumOfSubs + TsTv*sumOfSubs, data=mut))
summary(glm(Cockroaches ~ TsTv + sumOfSubs, data=mut))
plot(mut$sumOfSubs, mut$TsTv)
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
plot(mut$sumOfSubs, mut$TsTv)
summary(glm(Cockroaches ~ TsTv + sumOfSubs, data=mut))
summary(glm(Cockroaches ~ TsTv*sumOfSubs, data=mut))
summary(glm(scale(Cockroaches) ~ TsTv*sumOfSubs, data=mut))
summary(glm(Cockroaches ~ TsTv + sumOfSubs, data=mut))
pdf('../results/cockroaches11_19/TsTvNormalization.R.pdf')
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
plot(mut$sumOfSubs, mut$TsTv)
dev.off()
rm(list=ls(all=TRUE))
mut = read.table('../results/cockroaches11_19/MutSpecCockroachesTsTv.txt', sep='\t', header=TRUE)
plot(mut$sumOfSubs, mut$BranchLength)
plot(mut$sumOfSubs, mut$TsTv)
cor.test(mut$sumOfSubs, mut$TsTv, method = 'spearman')
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
plot(mut$sumOfSubs, mut$TsTv)
cor.test(mut$Ts, mut$Tv, method = 'spearman')
a = lm(Ts ~ Tv, mut)
summary(a)
res = a$residuals
cor.test(mut$BranchLength, res, method = 'spearman')
summary(glm(Cockroaches ~ TsTv + sumOfSubs, data=mut))
summary(glm(Cockroaches ~ TsTv, data=mut))
summary(glm(Cockroaches ~ sumOfSubs, data=mut))
summary(glm(Cockroaches ~ TsTv + sumOfSubs, data=mut))
summary(glm(TsTv ~ Cockroaches + sumOfSubs, data=mut))
summary(glm(Cockroaches ~ TsTv + sumOfSubs, data=mut))
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
plot(mut$sumOfSubs, mut$TsTv)
library(ggplot2)
ggplot(mut, aes(Ts, Tv, fill = Taxonomy)) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = Taxonomy)) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point()
ggplot(mut, aes(Ts, Tv, fill = Cockroaches)) +
geom_point()
summary(mut$Cockroaches)
ggplot(mut, aes(Ts, Tv, fill = as.factor(Cockroaches))) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = as.factor(Cockroaches))) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = Taxonomy)) +
geom_point()
pdf('../results/cockroaches11_19/TsTvNormalization.R.pdf')
plot(mut$sumOfSubs, mut$TsTv)
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
ggplot(mut, aes(Ts, Tv, col = as.factor(Cockroaches))) +
geom_point()
dev.off()
ggplot(mut, aes(Ts, Tv, col = as.factor(Cockroaches))) +
geom_point() + + scale_fill_discrete(name = 'Cockroaches')
ggplot(mut, aes(Ts, Tv, col = as.factor(Cockroaches))) +
geom_point() + scale_fill_discrete(name = 'Cockroaches')
ggplot(mut, aes(Ts, Tv, col = as.factor(Cockroaches))) +
geom_point() + scale_fill_discrete(title = 'Cockroaches')
ggplot(mut, aes(Ts, Tv, col = as.factor(Cockroaches))) +
geom_point() + scale_fill_discrete(name = 'Cockroaches')
ggplot(mut, aes(Ts, Tv, col = as.factor(Cockroaches))) +
geom_point() + scale_fill_discrete(name = '')
ggplot(mut, aes(Ts, Tv, col = as.factor(Cockroaches))) +
geom_point() + # scale_fill_discrete(name = '')
labs(fill = '')
ggplot(mut, aes(Ts, Tv, col = as.factor(Cockroaches))) +
geom_point() + # scale_fill_discrete(name = '')
labs(fill = 'Cockroaches')
ggplot(mut, aes(Ts, Tv, col = as.factor(Cockroaches))) +
geom_point() + scale_fill_discrete(name = 'Cockroaches', labels = c('A', 'B'))
mut$Cockroaches = as.factor(mut$Cockroaches)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point()
pdf('../results/cockroaches11_19/TsTvNormalization.R.pdf')
plot(mut$sumOfSubs, mut$TsTv)
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
mut$Cockroaches = as.factor(mut$Cockroaches)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point()
dev.off()
unique(mut$Taxonomy)
higher_termites = c('Apicotermitinae', 'Cubitermitinae', 'Foraminitermitinae',
'Macrotermitinae', 'Nasutitermitinae', 'Sphaerotermitinae',
'Syntermitinae', 'Termes-group')
i = 1
mut[i, 'Taxonomy']
mut[i, 'Taxonomy'] %in% higher_termites
for(i in 1:nrow(mut)){
# i = 1
if(mut[i, 'Taxonomy'] %in% higher_termites){
mut[i, 'Higher_termites'] = 1
}
else{mut[i, 'Higher_termites'] = 0}
}
View(mut)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(col = higher_termites)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(col = higher_termites))
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(fill = higher_termites))
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(fill = Higher_termites))
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(col = as.factor(Higher_termites)))
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(fill = as.factor(Higher_termites)))
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(col = as.factor(Higher_termites)))
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = as.factor(Higher_termites)))
mut$Higher_termites = as.factor(mut$Higher_termites)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = Higher_termites))
pdf('../results/cockroaches11_19/TsTvNormalization.R.pdf')
plot(mut$sumOfSubs, mut$TsTv)
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
mut$Cockroaches = as.factor(mut$Cockroaches)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = Higher_termites))
dev.off()
rm(list=ls(all=TRUE))
library(ggplot2)
mut = read.table('../results/cockroaches11_19/MutSpecCockroachesTsTv.txt', sep='\t', header=TRUE)
plot(mut$sumOfSubs, mut$BranchLength)
plot(mut$sumOfSubs, mut$TsTv)
cor.test(mut$sumOfSubs, mut$TsTv, method = 'spearman')
unique(mut$Taxonomy)
higher_termites = c("Apicotermitinae", "Cephalo-group", "Microcerotermes",
"Termes-group", "Nasutitermitinae", "Amitermes-group",
"Promiro", "Macrotermitinae", "Cubitermitinae", "Foraminitermitinae",
"Syntermitinae", "Sphaerotermitinae", "Neocapri-group",
'Pericapritermes-group', "pericapritermes-group")
else{mut[i, 'HigherTermites'] = 0}
for(i in 1:nrow(mut)){
# i = 1
if(mut[i, 'Taxonomy'] %in% higher_termites){
mut[i, 'HigherTermites'] = 1
}
else{mut[i, 'HigherTermites'] = 0}
}
mut$Higher_termites = as.factor(mut$Higher_termites)
mut$HigherTermites = as.factor(mut$HigherTermites)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = Higher_termites))
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = HigherTermites))
mut$Cockroaches = as.factor(mut$Cockroaches)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = HigherTermites))
ggplot(mut[, mut$HigherTermites == 1], aes(Ts, Tv, col = Taxonomy)) +
geom_point()
View(mut)
View(mut)
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point()
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point()
install.packages("wesanderson")
library(wesanderson)
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point()
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_fill_manual(values=wes_palette(n=3, name="GrandBudapest"))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_color_manual(values=wes_palette(n=3, name="GrandBudapest"))
?wes_palette
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_color_manual(values=wes_palette(n=3, name="GrandBudapest1"))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_color_manual(values=wes_palette(n=15, name="GrandBudapest1"))
install.packages("scales")
install.packages("scales")
install.packages("scales")
rm(list=ls(all=TRUE))
install.packages("scales")
install.packages("scales")
install.packages("scales")
library(scales)
library(ggplot2)
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_color_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
mut = read.table('../results/cockroaches11_19/MutSpecCockroachesTsTv.txt', sep='\t', header=TRUE)
higher_termites = c("Apicotermitinae", "Cephalo-group", "Microcerotermes",
"Termes-group", "Nasutitermitinae", "Amitermes-group",
"Promiro", "Macrotermitinae", "Cubitermitinae", "Foraminitermitinae",
"Syntermitinae", "Sphaerotermitinae", "Neocapri-group",
'Pericapritermes-group', "pericapritermes-group")
for(i in 1:nrow(mut)){
# i = 1
if(mut[i, 'Taxonomy'] %in% higher_termites){
mut[i, 'HigherTermites'] = 1
}
else{mut[i, 'HigherTermites'] = 0}
}
mut$HigherTermites = as.factor(mut$HigherTermites)
mut$Cockroaches = as.factor(mut$Cockroaches)
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_color_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
?pal_simpsons
??pal_simpsons
library(scales)
library(ggplot2)
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_color_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
library(ggplot2)
mut = read.table('../results/cockroaches11_19/MutSpecCockroachesTsTv.txt', sep='\t', header=TRUE)
plot(mut$sumOfSubs, mut$BranchLength)
higher_termites = c("Apicotermitinae", "Cephalo-group", "Microcerotermes",
"Termes-group", "Nasutitermitinae", "Amitermes-group",
"Promiro", "Macrotermitinae", "Cubitermitinae", "Foraminitermitinae",
"Syntermitinae", "Sphaerotermitinae", "Neocapri-group",
'Pericapritermes-group', "pericapritermes-group")
for(i in 1:nrow(mut)){
# i = 1
if(mut[i, 'Taxonomy'] %in% higher_termites){
mut[i, 'HigherTermites'] = 1
}
else{mut[i, 'HigherTermites'] = 0}
}
mut$HigherTermites = as.factor(mut$HigherTermites)
mut$Cockroaches = as.factor(mut$Cockroaches)
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_color_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
library(scales)
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_color_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_color_palname(values=pal_simpsons(palette = c("springfield"), alpha = 1))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_colour_palname(values=pal_simpsons(palette = c("springfield"), alpha = 1))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_colour_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
# install.packages("scales")
install.packages('ggsci')
library(ggsci)
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + scale_colour_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + # scale_colour_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
scale_color_simpsons(palette = c("springfield"), ncol=15)
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + # scale_colour_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
scale_color_simpsons(palette = c("springfield"))
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = HigherTermites))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + # scale_colour_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
scale_color_simpsons(palette = c("springfield"))
pdf('../results/cockroaches11_19/TsTvNormalization.R.pdf', width = 10, hight = 7)
pdf('../results/cockroaches11_19/TsTvNormalization.R.pdf', width = 10)
plot(mut$sumOfSubs, mut$TsTv)
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
mut$Cockroaches = as.factor(mut$Cockroaches)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = HigherTermites))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + # scale_colour_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
scale_color_simpsons(palette = c("springfield"))
dev.off()
unique(mut[mut$Cockroaches == 0, 'Taxonomy'])
manualcolors<-c('black','forestgreen', 'red2', 'orange', 'cornflowerblue',
'magenta', 'darkolivegreen4',
'indianred1', 'tan4', 'darkblue',
'mediumorchid1','firebrick4',  'yellowgreen', 'lightsalmon', 'tan3',
"tan1",'darkgray', 'wheat4', '#DDAD4B', 'chartreuse', 'seagreen1',
'moccasin', 'mediumvioletred', 'seagreen','cadetblue1',
"darkolivegreen1" ,"tan2" ,   "tomato3" , "#7CE3D8","gainsboro")
manualcolors<-c('black','forestgreen', 'red2', 'orange', 'cornflowerblue',
'magenta', 'darkolivegreen4',
'indianred1', 'tan4', 'darkblue',
'mediumorchid1','firebrick4',  'yellowgreen', 'lightsalmon', 'tan3',
"tan1",'darkgray', 'wheat4', '#DDAD4B', 'chartreuse', 'seagreen1',
'moccasin', 'mediumvioletred', 'seagreen','cadetblue1')
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
scale_colour_manual(manualcolors)
unique(mut[mut$Cockroaches == 0, 'Taxonomy'])
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
scale_colour_manual(values = manualcolors)
manualcolors<-c('black','forestgreen', 'red2', 'orange', 'cornflowerblue',
'magenta', 'darkolivegreen4',
'indianred1', 'tan4', 'darkblue',
'mediumorchid1','firebrick4',  'yellowgreen', 'lightsalmon', 'tan3',
"tan1",'darkgray', 'wheat4', '#DDAD4B', 'chartreuse', 'seagreen1',
'moccasin', 'mediumvioletred', 'seagreen','cadetblue1', "darkolivegreen1")
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
scale_colour_manual(values = manualcolors)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
scale_color_manual(values = palette_OkabeIto_black)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
scale_color_manual(values = manualcolors)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() +
scale_color_manual(values = manualcolors)
View(mut)
summary(mut$Taxonomy)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point(size = HigherTermites) +
scale_color_manual(values = manualcolors)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point(aes(size = HigherTermites)) +
scale_color_manual(values = manualcolors)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() +
scale_color_manual(values = manualcolors)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point(aes(size = HigherTermites)) +
scale_color_manual(values = manualcolors)
pdf('../results/cockroaches11_19/TsTvNormalization.R.pdf', width = 11)
plot(mut$sumOfSubs, mut$TsTv)
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
mut$Cockroaches = as.factor(mut$Cockroaches)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = HigherTermites))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + # scale_colour_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
scale_color_simpsons(palette = c("springfield"))
unique(mut[mut$Cockroaches == 0, 'Taxonomy'])
manualcolors<-c('black','forestgreen', 'red2', 'orange', 'cornflowerblue',
'magenta', 'darkolivegreen4',
'indianred1', 'tan4', 'darkblue',
'mediumorchid1','firebrick4',  'yellowgreen', 'lightsalmon', 'tan3',
"tan1",'darkgray', 'wheat4', '#DDAD4B', 'chartreuse', 'seagreen1',
'moccasin', 'mediumvioletred', 'seagreen','cadetblue1', "darkolivegreen1")
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() +
scale_color_manual(values = manualcolors)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point(aes(size = HigherTermites)) +
scale_color_manual(values = manualcolors)
dev.off()
rm(list=ls(all=TRUE))
# install.packages("scales")
# install.packages('ggsci')
library(ggsci)
library(scales)
library(ggplot2)
mut = read.table('../results/cockroaches11_19/MutSpecCockroachesTsTv.txt', sep='\t', header=TRUE)
plot(mut$sumOfSubs, mut$BranchLength)
higher_termites = c("Apicotermitinae", "Cephalo-group", "Microcerotermes",
"Termes-group", "Nasutitermitinae", "Amitermes-group",
"Promiro", "Macrotermitinae", "Cubitermitinae", "Foraminitermitinae",
"Syntermitinae", "Sphaerotermitinae", "Neocapri-group",
'Pericapritermes-group', "pericapritermes-group")
for(i in 1:nrow(mut)){
# i = 1
if(mut[i, 'Taxonomy'] %in% higher_termites){
mut[i, 'HigherTermites'] = 1
}
else{mut[i, 'HigherTermites'] = 0}
}
mut$HigherTermites = as.factor(mut$HigherTermites)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = HigherTermites))
mut$Cockroaches = as.factor(mut$Cockroaches)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = HigherTermites))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() + # scale_colour_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
scale_color_simpsons(palette = c("springfield"))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point(aes(size = 2)) + # scale_colour_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
scale_color_simpsons(palette = c("springfield"))
unique(mut[mut$Cockroaches == 0, 'Taxonomy'])
manualcolors<-c('#543005','#8c510a','#bf812d','#dfc27d','#f6e8c3','#f5f5f5','#c7eae5','#80cdc1','#35978f','#01665e','#003c30',
'#a50026','#d73027','#f46d43','#fdae61','#fee090','#ffffbf','#e0f3f8','#abd9e9','#74add1','#4575b4','#313695',
'#8e0152','#c51b7d','#de77ae','#f1b6da','#fde0ef','#f7f7f7','#e6f5d0','#b8e186','#7fbc41','#4d9221','#276419')
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point() +
scale_color_manual(values = manualcolors)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point(aes(size = 1.5)) +
scale_color_manual(values = manualcolors)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point(aes(size = HigherTermites)) +
scale_color_manual(values = manualcolors)
pdf('../results/cockroaches11_19/TsTvNormalization.R.pdf', width = 11)
plot(mut$sumOfSubs, mut$TsTv)
plot(mut$sumOfSubs, mut$Ts)
plot(mut$sumOfSubs, mut$Tv)
plot(mut$Ts, mut$Tv)
mut$Cockroaches = as.factor(mut$Cockroaches)
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point()
ggplot(mut, aes(Ts, Tv, col = Cockroaches)) +
geom_point(aes(size = HigherTermites))
ggplot(mut[mut$HigherTermites == 1,], aes(Ts, Tv, col = Taxonomy)) +
geom_point(aes(size = 1.5)) + # scale_colour_manual(values=pal_simpsons(palette = c("springfield"), alpha = 1))
scale_color_simpsons(palette = c("springfield"))
unique(mut[mut$Cockroaches == 0, 'Taxonomy'])
manualcolors<-c('#543005','#8c510a','#bf812d','#dfc27d','#f6e8c3','#f5f5f5','#c7eae5','#80cdc1','#35978f','#01665e','#003c30',
'#a50026','#d73027','#f46d43','#fdae61','#fee090','#ffffbf','#e0f3f8','#abd9e9','#74add1','#4575b4','#313695',
'#8e0152','#c51b7d','#de77ae','#f1b6da','#fde0ef','#f7f7f7','#e6f5d0','#b8e186','#7fbc41','#4d9221','#276419')
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point(aes(size = 1.5)) +
scale_color_manual(values = manualcolors)
ggplot(mut[mut$Cockroaches == 0,], aes(Ts, Tv, col = Taxonomy)) +
geom_point(aes(size = HigherTermites)) +
scale_color_manual(values = manualcolors)
dev.off()
